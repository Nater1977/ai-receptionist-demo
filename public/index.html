<!DOCTYPE html>
<html>
<head>
  <title>AI Receptionist Demo</title>
</head>
<body>
  <h2>Checkered Flag Auto Center â€“ AI Receptionist Test</h2>
  <button id="start">Start Receptionist</button>
  <script>
    document.getElementById("start").onclick = async () => {
      const ws = new WebSocket("wss://" + location.host);

      ws.onopen = () => {
        console.log("Connected.");
      };

      ws.onmessage = (event) => {
        const msg = JSON.parse(event.data);
        console.log(msg);
      };

      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      const processor = new MediaRecorder(stream, { mimeType: "audio/webm" });

      processor.ondataavailable = (e) => {
        ws.send(e.data);
      };

      processor.start(100);
    };
  </script>
</body>
</html>
